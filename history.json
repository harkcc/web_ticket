[
  {
    "task_id": "20241220100511",
    "type": "packing_list",
    "timestamp": "20241220_100518",
    "input_file": "20241220100511_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: local variable 'total_price' referenced before assignment\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 60, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 254, in _fill_dingdang_template\n    (5, total_price),\nUnboundLocalError: local variable 'total_price' referenced before assignment\n"
  },
  {
    "task_id": "20241220100808",
    "type": "packing_list",
    "timestamp": "20241220_100819",
    "input_file": "20241220100808_invoice_info.xlsx",
    "output_file": "20241220100808.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220100808.xlsx",
    "address_info_status": "failed"
  },
  {
    "task_id": "20241220101344",
    "type": "packing_list",
    "timestamp": "20241220_101355",
    "input_file": "20241220101344_invoice_info.xlsx",
    "output_file": "20241220101344.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220101344.xlsx",
    "address_info_status": "failed"
  },
  {
    "task_id": "20241220101433",
    "type": "packing_list",
    "timestamp": "20241220_101434",
    "input_file": "20241220101433_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: An error occurred while opening tunnels.\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 60, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 137, in _fill_dingdang_template\n    with self.db_connector as db:\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/db_connector.py\", line 64, in __enter__\n    return self.connect()\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/db_connector.py\", line 30, in connect\n    self.tunnel.start()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/sshtunnel.py\", line 1344, in start\n    self._raise(HandlerSSHTunnelForwarderError,\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/sshtunnel.py\", line 1174, in _raise\n    raise exception(reason)\nsshtunnel.HandlerSSHTunnelForwarderError: An error occurred while opening tunnels.\n"
  },
  {
    "task_id": "20241220101512",
    "type": "packing_list",
    "timestamp": "20241220_101519",
    "input_file": "20241220101512_invoice_info.xlsx",
    "output_file": "20241220101512.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220101512.xlsx"
  },
  {
    "task_id": "20241220102447",
    "type": "packing_list",
    "timestamp": "20241220_102454",
    "input_file": "20241220102447_invoice_info.xlsx",
    "output_file": "20241220102447.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220102447.xlsx"
  },
  {
    "task_id": "20241220104108",
    "type": "packing_list",
    "timestamp": "20241220_104110",
    "input_file": "20241220104108_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: '>' not supported between instances of 'str' and 'int'\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 60, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 260, in _fill_dingdang_template\n    (5, total_price if total_price > 0 else \"\"),  # 仅在总价格大于0时填入\nTypeError: '>' not supported between instances of 'str' and 'int'\n"
  },
  {
    "task_id": "20241220104352",
    "type": "packing_list",
    "timestamp": "20241220_104355",
    "input_file": "20241220104352_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: could not convert string to float: ''\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 60, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 252, in _fill_dingdang_template\n    total_price = float(product_info.get('price', 0)) * item.box_quantities.get(box_number, 0) if product_info else 0\nValueError: could not convert string to float: ''\n"
  },
  {
    "task_id": "20241220105328",
    "type": "packing_list",
    "timestamp": "20241220_105336",
    "input_file": "20241220105328_invoice_info.xlsx",
    "output_file": "20241220105328.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220105328.xlsx",
    "address_info_status": "failed"
  },
  {
    "task_id": "20241220113604",
    "type": "packing_list",
    "timestamp": "20241220_113605",
    "input_file": "20241220113604_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: Cannot convert {'seller_info': {'sellerName': 'BT-US', 'sid': 505674, 'inboundPlanId': 'wfd649be2a-1983-43a6-a5dd-cd0061e25129'}, 'address_info': {'addressLine1': '1151 S GRAHAM RD', 'addressLine2': None, 'city': 'GREENWOOD', 'companyName': '', 'countryCode': 'US', 'name': 'IND9', 'postalCode': '46143-7830', 'stateOrProvinceCode': 'IN', 'phoneNumber': None, 'email': None}} to Excel\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 69, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 150, in _fill_dingdang_template\n    sheet['A2'] = address_info  # 地址信息\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/worksheet/worksheet.py\", line 318, in __setitem__\n    self[key].value = value\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/cell/cell.py\", line 218, in value\n    self._bind_value(value)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/cell/cell.py\", line 187, in _bind_value\n    raise ValueError(\"Cannot convert {0!r} to Excel\".format(value))\nValueError: Cannot convert {'seller_info': {'sellerName': 'BT-US', 'sid': 505674, 'inboundPlanId': 'wfd649be2a-1983-43a6-a5dd-cd0061e25129'}, 'address_info': {'addressLine1': '1151 S GRAHAM RD', 'addressLine2': None, 'city': 'GREENWOOD', 'companyName': '', 'countryCode': 'US', 'name': 'IND9', 'postalCode': '46143-7830', 'stateOrProvinceCode': 'IN', 'phoneNumber': None, 'email': None}} to Excel\n"
  },
  {
    "task_id": "20241220114355",
    "type": "packing_list",
    "timestamp": "20241220_114356",
    "input_file": "20241220114355_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: __enter__\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 69, in generate_invoice\n    template_handler(wb, box_data, code, address_info)\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 151, in _fill_dingdang_template\n    with self.db_connector as db:\nAttributeError: __enter__\n"
  },
  {
    "task_id": "20241220114641",
    "type": "packing_list",
    "timestamp": "20241220_114644",
    "input_file": "20241220114641_invoice_info.xlsx",
    "output_file": "20241220114641.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220114641.xlsx"
  },
  {
    "task_id": "20241220115541",
    "type": "packing_list",
    "timestamp": "20241220_115544",
    "input_file": "20241220115541_invoice_info.xlsx",
    "output_file": "20241220115541.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220115541.xlsx"
  },
  {
    "task_id": "20241220115726",
    "type": "packing_list",
    "timestamp": "20241220_115730",
    "input_file": "20241220115726_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: [Errno 2] No such file or directory: '/Users/chenminghui/py/lingxing_request/web_ticket/图片测试/temp_2309-Id-Z-0004-10Bead-EMBT.jpg'\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 81, in generate_invoice\n    wb.save(output_path)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/workbook/workbook.py\", line 386, in save\n    save_workbook(self, filename)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 294, in save_workbook\n    writer.save()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 275, in save\n    self.write_data()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 79, in write_data\n    self._write_images()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 116, in _write_images\n    self._archive.writestr(img.path[1:], img._data())\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/drawing/image.py\", line 48, in _data\n    img = _import_image(self.ref)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/drawing/image.py\", line 16, in _import_image\n    img = PILImage.open(img)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/PIL/Image.py\", line 3469, in open\n    fp = builtins.open(filename, \"rb\")\nFileNotFoundError: [Errno 2] No such file or directory: '/Users/chenminghui/py/lingxing_request/web_ticket/图片测试/temp_2309-Id-Z-0004-10Bead-EMBT.jpg'\n"
  },
  {
    "task_id": "20241220115841",
    "type": "packing_list",
    "timestamp": "20241220_115844",
    "input_file": "20241220115841_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "生成发票时发生错误: 'Image' object has no attribute 'fp'\nTraceback (most recent call last):\n  File \"/Users/chenminghui/py/lingxing_request/web_ticket/generator.py\", line 81, in generate_invoice\n    wb.save(output_path)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/workbook/workbook.py\", line 386, in save\n    save_workbook(self, filename)\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 294, in save_workbook\n    writer.save()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 275, in save\n    self.write_data()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 79, in write_data\n    self._write_images()\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/writer/excel.py\", line 116, in _write_images\n    self._archive.writestr(img.path[1:], img._data())\n  File \"/Users/chenminghui/py/lingxing_request/venv/lib/python3.10/site-packages/openpyxl/drawing/image.py\", line 51, in _data\n    img.fp.seek(0)\nAttributeError: 'Image' object has no attribute 'fp'\n"
  },
  {
    "task_id": "20241220115947",
    "type": "packing_list",
    "timestamp": "20241220_115950",
    "input_file": "20241220115947_invoice_info.xlsx",
    "output_file": "20241220115947.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220115947.xlsx"
  },
  {
    "task_id": "20241220143430",
    "type": "packing_list",
    "timestamp": "20241220_143435",
    "input_file": "20241220143430_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "InvoiceGenerator.generate_invoice() takes from 3 to 5 positional arguments but 6 were given"
  },
  {
    "task_id": "20241220143508",
    "type": "packing_list",
    "timestamp": "20241220_143509",
    "input_file": "20241220143508_invoice_info.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "failed",
    "error": "InvoiceGenerator.generate_invoice() takes from 3 to 5 positional arguments but 6 were given"
  },
  {
    "task_id": "20241220144358",
    "type": "packing_list",
    "timestamp": "20241220_144402",
    "input_file": "20241220144358_invoice_info.xlsx",
    "output_file": "20241220144359.xlsx",
    "code_input": "FBA18NXMB5RK",
    "template_name": "叮铛卡航限时达",
    "status": "completed",
    "result_file": "20241220144359.xlsx"
  }
]